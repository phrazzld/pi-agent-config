plan-build-review:
  description: "Fast default pipeline: plan, implement, review"
  steps:
    - agent: planner
      prompt: "Create an implementation plan for: $INPUT"
    - agent: worker
      prompt: "Execute this plan with focused changes and verification:\n\n$INPUT"
    - agent: reviewer
      prompt: "Review this implementation for correctness, risk, and maintainability:\n\n$INPUT"

plan-critique-build-review:
  description: "Safer default for non-trivial work: plan, critique, build, review"
  steps:
    - agent: planner
      prompt: "Create an implementation plan for: $INPUT"
    - agent: plan-reviewer
      prompt: "Critique this plan for missing steps, bad sequencing, and unmitigated risks:\n\n$INPUT\n\nOriginal goal: $ORIGINAL"
    - agent: worker
      prompt: "Implement using the plan + critique guidance. Keep scope tight and verify behavior:\n\n$INPUT"
    - agent: reviewer
      prompt: "Review the implementation for bugs, maintainability, and deployment risk:\n\n$INPUT"

software-delivery-v1:
  description: "General product engineering flow: plan, critique, build, review, docs"
  checkpoints:
    - before-build
    - before-pr
  steps:
    - agent: planner
      prompt: "Create an execution plan for: $INPUT"
    - agent: plan-reviewer
      prompt: "Critique this plan and require risk/test coverage before implementation:\n\n$INPUT\n\nOriginal goal: $ORIGINAL"
    - agent: worker
      prompt: "Implement the approved plan with focused scope and verification:\n\n$INPUT"
    - agent: reviewer
      prompt: "Run blocking review for correctness, maintainability, and risk:\n\n$INPUT"
    - agent: documenter
      prompt: "Prepare concise PR-ready summary/docs evidence:\n\n$INPUT"

meta-council-v1:
  description: "Pi-meta architecture council pass for config, extensions, skills, prompts, and UI"
  checkpoints:
    - after-recon
    - before-implementation
  steps:
    - agent: scout
      prompt: "Map the Pi config areas most relevant to this objective:\n\n$INPUT"
    - agent: meta-agent-expert
      prompt: "Evaluate agent role boundaries and handoff quality for this objective:\n\n$INPUT"
    - agent: meta-config-expert
      prompt: "Evaluate slice/config topology and global-vs-local responsibilities:\n\n$INPUT"
    - agent: meta-extension-expert
      prompt: "Evaluate extension composition and observability design:\n\n$INPUT"
    - agent: meta-team-ui-expert
      prompt: "Evaluate team/pipeline UI visibility and operator ergonomics:\n\n$INPUT"
    - agent: planner
      prompt: "Synthesize prior findings into a concrete implementation plan:\n\n$INPUT\n\nOriginal goal: $ORIGINAL"

autopilot-v1:
  description: "Bounded issue-to-PR flow with explicit checkpoints"
  checkpoints:
    - after-intake
    - before-pr
    - before-merge
  steps:
    - agent: scout
      prompt: "Issue intake: identify the highest-priority open issue, summarize acceptance criteria, and list constraints.\n\nContext: $INPUT"
    - agent: planner
      prompt: "Produce an execution plan for this issue with explicit risks and tests.\n\n$INPUT"
    - agent: plan-reviewer
      prompt: "Critique this plan and force corrections before implementation.\n\n$INPUT\n\nOriginal objective: $ORIGINAL"
    - agent: worker
      prompt: "Implement the approved plan end-to-end with minimal scope creep and run verification.\n\n$INPUT"
    - agent: reviewer
      prompt: "Perform a blocking review. Classify findings by severity and include must-fix items before PR.\n\n$INPUT"
    - agent: red-team
      prompt: "Run an adversarial review for security and abuse/failure paths. Report blocking findings only.\n\n$INPUT"
    - agent: documenter
      prompt: "Prepare PR-ready summary/docs evidence: what changed, why, verification, and residual risk.\n\n$INPUT"
    - agent: reviewer
      prompt: "Final merge-readiness check against the original objective. Confirm blockers resolved or explicitly deferred.\n\nOriginal objective: $ORIGINAL\n\nCurrent state: $INPUT"

autopilot-issue-v2:
  description: "Issue-to-PR bounded autopilot with distinct phase agents/models and an explicit verifier loop"
  checkpoints:
    - after-intake-spec
    - before-build
    - before-pr
    - before-merge
  steps:
    - agent: autopilot-intake
      prompt: "Select and frame one issue for execution. If issue ID is provided, use it; otherwise choose highest-priority open issue by labels/horizon/number.\n\nContext: $INPUT"
    - agent: autopilot-spec
      prompt: "Convert intake output into a scoped execution contract with acceptance criteria, test plan, and rollback triggers.\n\n$INPUT"
    - agent: autopilot-design-critic
      prompt: "Pressure-test this execution contract. Return blockers, sequencing fixes, and a ready/not-ready verdict.\n\n$INPUT"
    - agent: autopilot-implementer
      prompt: "Implement the approved plan with minimal scope. Run focused verification and CI-parity checks relevant to changed files.\n\n$INPUT"
    - agent: autopilot-verifier
      prompt: "Run blocking verification. Classify findings by severity and return PASS/FAIL.\n\n$INPUT"
    - agent: autopilot-implementer
      prompt: "If verifier reported blockers, apply the smallest safe fixes only for critical/high issues and rerun targeted checks. If PASS, make no-op and report unchanged.\n\n$INPUT"
    - agent: autopilot-verifier
      prompt: "Final gate check after fix loop. Confirm blockers resolved or explicitly deferred with rationale.\n\n$INPUT"
    - agent: autopilot-pr-composer
      prompt: "Create or update PR with body-file hygiene, concise verification evidence, and residual risk section.\n\nOriginal objective: $ORIGINAL\n\nCurrent state: $INPUT"

groom-v1:
  description: "Pi-native grooming flow: strategy + research + critique + synthesis"
  checkpoints:
    - after-theme-map
    - before-issue-synthesis
  steps:
    - agent: groom-strategist
      prompt: "Identify the highest-leverage grooming themes for:\n\n$INPUT"
    - agent: groom-researcher
      prompt: "Validate these themes with external best practices and prior-art signals:\n\n$INPUT\n\nOriginal objective: $ORIGINAL"
    - agent: groom-critic
      prompt: "Critique scope, sequencing, and risk. Explicitly recommend what to drop or defer:\n\n$INPUT"
    - agent: groom-synthesizer
      prompt: "Synthesize into prioritized executable slices with acceptance criteria and an explicit ambition checkpoint decision:\n\n$INPUT\n\nOriginal objective: $ORIGINAL"

groom-ambition-v1:
  description: "Dedicated frontier-style ambition checkpoint for an existing plan/project"
  steps:
    - agent: groom-strategist
      prompt: "For this plan/project, propose three candidate high-leverage accretive additions:\n\n$INPUT"
    - agent: groom-researcher
      prompt: "Research/validate the candidate additions and surface evidence-driven tradeoffs:\n\n$INPUT"
    - agent: groom-critic
      prompt: "Pressure-test the candidates for risk, complexity bloat, and reversibility:\n\n$INPUT"
    - agent: groom-synthesizer
      prompt: "Select the single best candidate (or reject all) and provide 72h validation, kill criteria, and rollback plan:\n\n$INPUT"

meta-refactor-v1:
  description: "Structured complexity-paydown loop: inventory -> hotspot selection -> refactor -> verification"
  checkpoints:
    - after-inventory
    - before-refactor
    - before-merge
  steps:
    - agent: scout
      prompt: "Inventory current runtime architecture and identify the single highest-leverage simplification hotspot for:\n\n$INPUT"
    - agent: planner
      prompt: "Design a minimal, root-cause refactor plan with explicit tests and verification for:\n\n$INPUT"
    - agent: reviewer
      prompt: "Critique this refactor plan for hidden coupling, migration risk, and missing regression coverage:\n\n$INPUT"
    - agent: worker
      prompt: "Execute the approved refactor with focused scope and regression tests:\n\n$INPUT"
    - agent: reviewer
      prompt: "Run merge-readiness review for correctness, reliability, and complexity reduction claims:\n\n$INPUT"
